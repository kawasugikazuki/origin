# Red2.0-Control-Software
## はじめに
このリポジトリはRed2.0実機を動かすためのプログラムが格納されているリポジトリである．
Red2.0を動かす際はこのリポジトリをクローンして，main.pyを実行すればロボットが動作する事になっている．

## 依存関係のについて
### インストール
すべてのロボットで環境を同一とするために，パッケージのインストール用シェルスクリプトを実行すること．
尚root権限が必要なコマンドを実行するため，`sudo`をつけて実行する必要がある．
```
cd install
sudo ./install.sh
```
### 追加・変更
これからの機能開発等で新たな依存パッケージ等が増える場合は，`install.sh`に追記をし，再度実行すれば良い．
また，Red2.0-Control-Softwareディレクトリの位置を移動した場合も`install.sh`を再実行する必要がある．

## 危惧される調整
ロボットのプログラムの起動はSSH接続で始めるように
カメラの座標系がどうなっているのか確認する必要あり（前方が角度0なのか, 147行目あたりのif文の条件に影響）
秒数　→　角度の計算を後でやる。具体的には実機が360度回転するのにかかる秒数を実験して、1度あたりにかかる時間を算出してほしい。
RED2はバックできない設計なので、下がるところは180度回転して戻るように!
マーカー認識にかかる時間次第で、ロボットの行動を全体的に遅くする必要がある。(sleepや旋回・前進速度の調整)

## 動作中のRedのログを確認する方法
ログを確認したいRedにSSH接続をすることが前提で，以下のコマンドを実行すればよい．
```
journalctl -u red2.0_main.service -f
```

## リポジトリ構成（2021/09/05更新）
本リポジトリの構成を以下に示す．尚，更新を行った場合はこの記述も更新すること．
```
Red2.0-Control-Software
  |- README.md
  |- explore_algorithm
    |- MainAlgorithm.py # メインの探査アルゴリズム
    |- MarkerIdentificationAlgorithm # マーカー検知アルゴリズム（いろんなファイルで分割されている）
    |- VL53L0X.py # VL53L0Xを動かすためのプログラム
    |- VL53L0X_multi_example.py # VL53L0Xを複数台動かすためのプログラム
    |- server.py # MQTT関係を操作するプログラム
    |- MotorControl.py # モータ（単体）の動作を操作するプログラム
    |- WheelControl.py # 両輪を操作しロボットを動かすためのプログラム
    |- FloorLight.py # 底面のLEDを制御するプログラム
  |- install
    |- bin
      |- init_gpio.sh # GPIOの初期状態を設定するスクリプト．自動起動するための設定で用いる
    |- etc
      |- gpio_initializer_base # init_gpio.shを自動起動するための設定ファイルのベース
      |- pigpiod # pigpiodを自動起動するための設定ファイル
      |- requirements.txt # インストールするpythonパッケージのリスト
    |- install.sh # 依存関係等を自動でインストールするためのシェルスクリプト．実行にはroot権限が必要
```